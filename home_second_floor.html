<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="home.css">
    <title>Document</title>
</head>
<body>

<!-- <nav class="top_nav"> -->

    
    <!-- <a href="Maps.html"><img class="Maps_icon" src="Map.png"></a> -->

</nav>

<div class="bottom_nav">
    <nav class="navbar">
        <a href="home.html"><img class="elements_navbar" src="explore_24dp_black.png"></a>
        <a href="libraryMAIN.html"><img class="elements_navbar" src="library_books_24dp_666666.png"></a>
        <a href="contactusMAIN.html"><img class="elements_navbar" src="email_24dp_666666.png"></a>
        <a href="AboutsusMAIN.html"><img class="elements_navbar" src="account_balance_24dp_666666.png"></a>
        <a href="Maps.html"><img class="elements_navbar" src="map_24dp_666666_FILL0_wght400_GRAD0_opsz24.png"></a>
        <a href="register.php"><img class="elements_navbar" src="logout_24dp_666666_FILL0_wght400_GRAD0_opsz24.png"></a>
    </nav>
</div>

<section class="section1">
    <div class="container_one">
        <div class="image_input">
            <div class="image">
                <img style="height:30px;" src="my_location_24dp_000000.png">
            </div>
            <input id="from-block" class="input_tag" type="text" placeholder="Where are you?" list="location-options">
            <datalist id="location-options">
                <option value="Staircase"></option>
                

            </datalist>
        </div>
        <div class="image_input">
            <div class="image">
                <img src="place_24dp.png">
            </div>
            <input id="to-block" class="input_tag" type="text" placeholder="Where you want to go" list="locations">
        </div>
    </div>
    <datalist id="locations">
        <option value="Main gate">
        <option value="S-201">
        <option value="S-202">
        <option value="S-203">
        <option value="S-204">
        <option value="S-205">
        <option value="S-206">
        <option value="S-207">
        <option value="S-208">
        <option value="S-209">
        <option value="S-210">
        <option value="S-211">
        <option value="S-212">
        <option value="S-213">
        <option value="R-201">
        <option value="R-202">
        <option value="R-203">
        <option value="R-204">
        <option value="R-205">
        <option value="L-201">
        <option value="L-202">
        <option value="O-201">
        <option value="O-202">
        <option value="O-203">
        <option value="O-204">
        <option value="T-201">
        <option value="T-202">
        <option value="T-203">
        <option value="T-204">
        <option value="P-203">
        <option value="P-204">
        <option value="P-205">
        <option value="J-201">
        <option value="J-202">
        <option value="J-203">
        <option value="J-204">
        <option value="J-205">
        <option value="Toilet">
        <option value="Workshop">
        <option value="Court">
        <option value="Playground">
        <option value="Parking">
        <option value="Architecture building">
        <option value="Reception">
        <option value="Canteen">
    </datalist>

    <div class="image-container">
        <canvas id="layoutCanvas" width="600" height="400"></canvas>
    </div>
    <p  class="bottom_para">Copyright Â© CAMPUS CRUISE | All rights reserved</p>
    <p  class="bottom_para1">You're at second floor
    </p>

   <div style="display:flex; justify-content:space-evenly; height:100px; width:300px;">
    <button style="height:60px;width:120px ;position:relative;left:680px;font-size: 20px;" id="find-path">Find Path</button>
    <a href="home_third_floor.html" id="next"  >Next floor</a>
    </div>
</section>

<script>
    try {
        const blockCoordinates = {
            "Main gate": { x: 15, y: 305 },
            "S-201": { x: 70, y: 245 },
            "S-202": { x: 80, y: 90 },
            "S-203": { x: 120, y: 90 },
            "S-204": { x: 120, y: 95 },
            "S-205": { x: 120, y: 135 },
            "S-206": { x: 120, y: 145 },
            "S-207": { x: 120, y: 220 },
            "S-208": { x: 120, y: 226 },
            "S-209": { x: 120, y: 265 },
            "S-210": { x: 120, y: 270 },
            "S-111": { x: 120, y: 240 },
            "S-112": { x: 120, y: 260 },
            "S-113": { x: 120, y: 270 },
            "Toilet":{x:120,y:275},
            "R-201": { x: 130, y: 45 },
            "R-202": { x: 165, y: 45 },
            "R-203": { x: 225, y: 45 },
            "R-204": { x: 245, y: 45 },
            "R-205": { x: 265, y: 45 },
            "L-201": { x: 320, y: 40 },
            "L-102": { x: 360, y: 105 },
            "O-201": { x: 365, y: 153 },
            "O-202": { x: 355, y: 153 },
            "O-203": { x: 320, y: 153 },
            "O-204": { x: 320, y: 193 },
            "P-208": { x: 300, y: 315 },
            "P-205": { x: 365, y: 315 },
            "P-206": { x: 355, y: 315 },
            "J-201": { x: 390, y: 340 },
            "J-202": { x: 440, y: 340 },
            "J-203": { x: 550, y: 340 },
            "J-204": { x: 520, y: 340 },
            "J-205": { x: 520, y: 340 },
            "T-201": { x: 150, y: 300 },
            "T-202": { x: 200, y: 300 },
            "T-203": { x: 250, y: 300 },
            "T-204": { x: 260, y: 300 },
            "J-001": { x: 230, y: 280 },
            
            "Staircase":{x:60 ,y: 315},
            
            "Architecture building":{x:500,y:185},
            
        };

        const canvas = document.getElementById('layoutCanvas');
    const ctx = canvas.getContext('2d');
    const image = new Image();
    image.src = 'second_floor.jpg';  // Ensure this is a high-res image


        let imageLoaded = false;

        image.onload = () => {
            ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
            imageLoaded = true;
        };

        function findPath() {
            const fromBlock = document.getElementById('from-block').value;
            const toBlock = document.getElementById('to-block').value;

            if (!blockCoordinates[fromBlock] || !blockCoordinates[toBlock]) {
                alert('Please enter valid block names.');
                return;
            }

            if (imageLoaded) {
                drawPathWithWaypoints(fromBlock, toBlock);
            } else {
                console.log('Image is still loading. Please wait.');
            }

            findPathButton.classList.add('active');
            setTimeout(() => {
                findPathButton.classList.remove('active');
            }, 300);
        }

        const findPathButton = document.getElementById('find-path');
        findPathButton.addEventListener('click', findPath);
        findPathButton.addEventListener('touchstart', (event) => {
            event.preventDefault();
            findPath();
        });

        function drawPathWithWaypoints(fromBlock, toBlock) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

            const start = blockCoordinates[fromBlock];
            const end = blockCoordinates[toBlock];

            const waypoints = {
               
                 "Staircase to S-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 245 },
                    end
                ],
                "Staircase to S-202": [
                start,
                    { x: 100, y: 315 },
                    { x: 100, y: 100 },
                    end],

                    "Staircase to S-203": [
                start,
                    { x: 100, y: 315 },
                    { x: 100, y: 90 },
                    end],
           
                "Staircase to S-204": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 95 },
                    end
                ],
                "Staircase to S-205": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 135 },
                    end
                ],
                 "Staircase to S-206": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 145 },
                    end
                ],
                "Staircase to S-207": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 220 },
                    end
                ],
                "Staircase to S-208": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 226 },
                    end
                ],
                "Staircase to S-209": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 265 },
                    end
                ],
                "Staircase to S-210": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 270},
                    end
                ],
                 "Staircase to S-111": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 240 },
                    end
                ],
                 "Staircase to S-112": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 260 },
                    end
                ],
                "Staircase to S-113": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 270 },
                    end
                ],
                "Staircase to Toilet": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 275 },
                    end
                ],
                "Staircase to R-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77 },
                    { x: 130, y: 77},
                    end
                ],
                "Staircase to R-202": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77 },
                    { x: 165, y: 77},
                    end
                ],
                "Staircase to R-203": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y:77 },
                    { x: 225, y:77},
                    end
                ],
                "Staircase to R-204": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y:77 },
                    { x: 245, y:77},
                    end
                ],
                "Staircase to R-205": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    end
                ],
               "Staircase to L-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    end
                ],

                "Staircase to L-102": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:105},
                    
                    end
                ],

                "Staircase to O-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:153},
                    
                    end
                ],

                "Staircase to O-202": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:153},
                    
                    end
                ],

                "Staircase to O-203": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:153},
                    
                    end
                ],

                "Staircase to O-204": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:193},
                    
                    end
                ],

                "Staircase to P-203": [
                    start,
                    { x: 100, y: 315 },
                    { x: 120, y: 310},
                    
                    
                    end
                ],

                "Staircase to P-208": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 290},
                    { x: 300, y: 290},
                    
                    end
                ],

                "Staircase to P-106": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:315},
                    
                    end
                ],

                "Staircase to J-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:340},
                    
                    end
                ],

                "Staircase to J-202": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:342},
                    { x: 440, y:342},
                    
                    end
                ],

                
                "Staircase to J-203": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:342},
                    { x: 480, y:342},
                    
                    end
                ],

                "Staircase to J-204": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:342},
                    { x: 520, y:342},
                    
                    end
                ],

                "Staircase to J-205": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:342},
                    { x: 520, y:342},
                    
                    end
                ],

                
                 
               
                "Staircase to T-201": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 290},
                    { x: 150, y: 290},
                    
                    end
                ],
                "Staircase to T-202": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 290},
                    { x: 200, y: 290},
                    
                    end
                ],
                "Staircase to T-203": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 290},
                    { x: 250, y: 290},
                    
                    end
                ],
                "Staircase to T-204": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 290},
                    { x: 260, y: 290},
                    
                    end
                ],
                "Staircase to Architecture building": [
                    start,
                    { x: 100, y: 315 },
                    { x: 100, y: 77},
                    { x: 265, y:77},
                    { x: 310, y:65},
                    { x: 390, y:65},
                    { x: 390, y:185},
                    
                    end
                ],




               


                // Add more waypoints here...
            };

            let selectedPath = waypoints[`${fromBlock} to ${toBlock}`];

            if (!selectedPath) {
                selectedPath = [start, end];
            }

            animateMovingDottedLine(selectedPath);
        }

        function animateMovingDottedLine(path) {
            let dashOffset = 0;
            const dashLength = 10; // Length of dashes
            const dashGap = 5; // Gap between dashes
            const animationSpeed = 0.3; // Speed of the movement

            function drawDottedLine() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

                ctx.setLineDash([dashLength, dashGap]);
                ctx.lineDashOffset = dashOffset;
                ctx.strokeStyle = 'red';
                ctx.lineWidth = 2;
                ctx.beginPath();

                ctx.moveTo(path[0].x, path[0].y);

                for (let i = 1; i < path.length; i++) {
                    const curr = path[i];
                    ctx.lineTo(curr.x, curr.y);
                }

                ctx.stroke();

                dashOffset -= animationSpeed;
                requestAnimationFrame(drawDottedLine);
            }

            drawDottedLine();
        }
    } catch (e) {
        alert("JavaScript error: " + e.message);
    }
</script>

<style>
    button {
        background-color: #f0f0e1;
        border: none;
        border-radius: 10px;
        padding: 10px 20px;
        cursor: pointer;
        font-size: 16px;
        margin-left:30px;
        margin-top:50px;
    }

    button.active {
        background-color: yellow;
    }
</style>

</body>
</html>
